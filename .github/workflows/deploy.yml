name: Deploy to GitHub Pages

on:
  schedule:
    - cron: '0 0 * * *'  # 毎日0時に実行

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Build Docker imagen
      run: docker build -t my-app .

    - name: Run script inside Docker container
      run: |
        docker create  my-app
        docker run --name temp_container -v ${{ github.workspace }}:/app --env TOKEN=${{ secrets.TOKEN }} my-app
        docker cp temp_container:/app/blog/_site ${{ github.workspace }}/blog/_site
        docker rm temp_container

    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.TOKEN }}
        publish_dir: ./blog/_site
        keep_files: true